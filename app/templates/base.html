<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <!-- Evitar que el navegador guarde caché -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta name="color-scheme" content="light dark">

    <script>
        // Aplicar dark-mode lo antes posible para evitar flasheo
        (function() {
            try {
                var isDark = localStorage.getItem('darkMode') === '1';
                if (isDark) {
                    document.documentElement.classList.add('dark-mode');
                    // En este punto body puede no existir aún; si existe, también aplicar
                    if (document.body) {
                        document.body.classList.add('dark-mode');
                    }
                    // Asegurar que cuando body se cree, mantenga la clase
                    new MutationObserver(function(mutations, observer){
                        if (document.body) {
                            document.body.classList.add('dark-mode');
                            observer.disconnect();
                        }
                    }).observe(document.documentElement, { childList: true, subtree: true });
                }
            } catch (e) { /* no-op */ }
        })();
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Flash Reserver{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/alerts.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/foro-multimedia.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/png">
</head>
    {% set auth_pages = ['auth.login', 'auth.register', 'auth.recuperar_password', 'auth.reset_password', 'auth.token_display', 'auth.cambiar_password'] %}
    <body class="{% block body_class %}{% endblock %}{% if current_user.is_authenticated and current_user.rol.Nombre in ['Administrador', 'Empleado'] %} admin-page{% elif current_user.is_authenticated and current_user.rol.Nombre == 'Cliente' %} client-page{% endif %}{% if request.endpoint in auth_pages %} auth-page{% endif %}">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('main.index') }}">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="logo">
                Flash Reserver
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        {% if current_user.is_authenticated %}
                            {% if current_user.rol.Nombre == 'Cliente' %}
                                <a class="nav-link" href="{{ url_for('client.ver_canchas') }}">
                                    <i class="fas fa-home"></i> Inicio
                                </a>
                            {% elif current_user.rol.Nombre in ['Administrador', 'Empleado'] %}
                                <a class="nav-link" href="{{ url_for('admin.dashboard') }}">
                                    <i class="fas fa-home"></i> Inicio
                                </a>
                            {% else %}
                                <a class="nav-link" href="{{ url_for('main.dashboard') }}">
                                    <i class="fas fa-home"></i> Inicio
                                </a>
                            {% endif %}
                        {% else %}
                            <a class="nav-link" href="{{ url_for('main.index') }}">
                                <i class="fas fa-home"></i> Inicio
                            </a>
                        {% endif %}
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('foro.index') }}">
                            <i class="fas fa-comments"></i> Foro
                        </a>
                    </li>
                    {% if current_user.is_authenticated %}
                        {% if current_user.rol.Nombre == 'Cliente' %}

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('client.mis_reservas') }}">
                                <i class="fas fa-calendar-check"></i> Mis Reservas
                            </a>
                        </li>
                        {% elif current_user.Rol in ['empleado', 'admin'] %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="fas fa-cogs me-1"></i>Administración
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{{ url_for('admin.dashboard') }}">
                                    <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin.canchas') }}">
                                    <i class="fas fa-futbol me-2"></i>Gestionar Canchas
                                </a></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin.reservas') }}">
                                    <i class="fas fa-calendar me-2"></i>Gestionar Reservas
                                </a></li>
                                {% if current_user.Rol == 'admin' %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin.usuarios') }}">
                                    <i class="fas fa-users me-2"></i>Gestionar Usuarios
                                </a></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin.categorias') }}">
                                    <i class="fas fa-tags me-2"></i>Gestionar Categorías
                                </a></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin.tipos_cancha') }}">
                                    <i class="fas fa-layer-group me-2"></i>Gestionar Tipos
                                </a></li>
                                {% endif %}
                            </ul>
                        </li>
                        {% endif %}
                    {% endif %}
                </ul>
                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                        {% if current_user.rol.Nombre in ['Administrador', 'Empleado'] %}
                        <!-- Botón de Mensajes para Admin -->
                        <li class="nav-item notification-btn">
                            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#notificationModal">
                                <i class="fas fa-comments"></i>
                                <span class="notification-badge" id="notificationCount" style="display: none;">0</span>
                            </a>
                        </li>
                        {% endif %}
                        


                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarDropdown"
                               role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <div class="position-relative">
                                    {% if current_user.FotoPerfil %}
                                        <img src="{{ url_for('static', filename=current_user.FotoPerfil) }}"
                                             alt="Avatar"
                                             class="rounded-circle me-2"
                                             width="32" height="32"
                                             style="object-fit: cover;">
                                    {% else %}
                                        <img src="{{ url_for('static', filename='images/default-user.png') }}"
                                             alt="Avatar por defecto"
                                             class="rounded-circle me-2"
                                             width="32" height="32"
                                             style="object-fit: cover;">
                                    {% endif %}
                                </div>
                                <span class="d-none d-lg-inline">{{ current_user.Nombre }}</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li>
                                <a class="dropdown-item" href="{{ url_for('admin.perfil') }}">
                                    <i class="fas fa-user-circle me-2"></i>Mi Perfil
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="{{ url_for('admin.configuracion') }}">
                                    <i class="fas fa-cog me-2"></i>Configuración
                                </a>
                            </li>
                            {% if current_user.rol.Nombre == 'Cliente' %}
                            <li>
                                <a class="dropdown-item" href="{{ url_for('client.ayuda') }}">
                                    <i class="fas fa-question-circle me-2"></i>Ayuda
                                </a>
                            </li>
                            {% elif current_user.rol.Nombre == 'Administrador' %}
                            <li>
                                <a class="dropdown-item" href="{{ url_for('admin.ayuda') }}">
                                    <i class="fas fa-question-circle me-2"></i>Ayuda
                                </a>
                            </li>
                            {% else %}

                            {% endif %}
                            <li>
                                <a class="dropdown-item" href="#" id="btn-darkmode">
                                    <i class="fas fa-moon me-2" id="theme-icon"></i><span id="theme-text">Tema Oscuro</span>
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="#" onclick="confirmarCerrarSesion()">
                                    <i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión
                                </a>
                            </li>
                        </ul>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('auth.login') }}">
                                <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('auth.register') }}">
                                <i class="fas fa-user-plus"></i> Registrarse
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div style="margin-top: 1rem;">
        {% block content %}{% endblock %}
    </div>

    {% if (request.endpoint not in ['auth.login', 'auth.register', 'auth.recuperar_password', 'auth.reset_password', 'auth.token_display']) and (show_footer is defined and show_footer) %}
    <footer class="footer bg-dark text-white pt-2 pb-1">
        <div class="container-fluid">
            <div class="row">
                <!-- Sección de información -->
                <div class="col-md-4 mb-2">
                    <h5 class="text-uppercase mb-1">
                        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="footer-logo me-2">Flash Reserver
                    </h5>
                    <p class="mb-1 small">Reserva tus canchas favoritas de manera rápida y sencilla. Disfruta del deporte con las mejores instalaciones.</p>
                    <div class="social-icons mt-1">
                        <a href="#" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white me-2"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>

                <!-- Enlaces rápidos -->
                <div class="col-md-2 mb-2">
                    <h5 class="text-uppercase mb-1">Enlaces</h5>
                    <ul class="list-unstyled">
                        <li class="mb-0"><a href="{{ url_for('main.index') }}" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Inicio</a></li>
                        <li class="mb-0"><a href="{{ url_for('client.ver_canchas') }}" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Canchas</a></li>
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Documentacion</a></li>
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Eventos</a></li>
                        <li class="mb-0"><a href="{{ url_for('foro.index') }}" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Foro</a></li>
                    </ul>
                </div>

                <!-- Legal -->
                <div class="col-md-3 mb-2">
                    <h5 class="text-uppercase mb-1">Legal</h5>
                    <ul class="list-unstyled">
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Términos y condiciones</a></li>
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Política de privacidad</a></li>
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Política de cookies</a></li>
                        <li class="mb-0"><a href="#" class="text-white text-decoration-none small"><i class="fas fa-chevron-right me-1"></i>Aviso legal</a></li>
                    </ul>
                </div>

                <!-- Contacto -->
                <div class="col-md-3 mb-2">
                    <h5 class="text-uppercase mb-1">Contacto</h5>
                    <ul class="list-unstyled">
                        <li class="mb-1 small"><i class="fas fa-map-marker-alt me-1"></i> Av. Deportiva 123, Ciudad</li>
                        <li class="mb-1 small"><i class="fas fa-phone me-1"></i> +1 234 567 890</li>
                        <li class="mb-1 small"><i class="fas fa-envelope me-1"></i> info@flashreserver.com</li>
                        <li class="small"><i class="fas fa-clock me-1"></i> Lunes-Viernes: 9:00 - 20:00</li>
                    </ul>
                </div>

                <!-- Manual de Usuario -->
                {% if current_user.is_authenticated and current_user.rol.Nombre == 'Cliente' %}
                <div class="col-md-3 mb-2">
                    <h5 class="text-uppercase mb-1">
                        <i class="fas fa-file-pdf me-2"></i>Manual Usuario
                    </h5>
                    <a href="{{ url_for('client.manual_usuario_pdf') }}" class="btn btn-danger btn-sm text-dark fw-bold">
                        <i class="fas fa-download me-1"></i>Descargar PDF
                    </a>
                </div>
                {% endif %}
                
                <!-- Manual de Administrador -->
                {% if current_user.is_authenticated and current_user.rol.Nombre == 'Administrador' %}
                <div class="col-md-3 mb-2">
                    <h5 class="text-uppercase mb-1">
                        <i class="fas fa-file-pdf me-2"></i>Manual Administrador
                    </h5>
                    <a href="{{ url_for('admin.manual_admin_pdf') }}" class="btn btn-danger btn-sm text-dark fw-bold">
                        <i class="fas fa-download me-1"></i>Descargar PDF
                    </a>
                </div>
                {% endif %}
            </div>

            <hr class="my-2 bg-light">

            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-0 small">&copy; <span id="currentYear"></span> Flash Reserver. Todos los derechos reservados.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0 small">Desarrollado con <i class="fas fa-heart text-danger"></i> por tu equipo</p>
                </div>
            </div>
        </div>
    </footer>
    {% endif %}

    <!-- Botón de Ayuda Flotante (solo para clientes) -->
    {% if current_user.is_authenticated and current_user.rol.Nombre == 'Cliente' %}
    <!-- Botón rectangular eliminado - solo se mantiene el botón circular flotante -->

    <!-- Modal de Mensaje Interno -->
    <div class="modal fade" id="mensajeModal" tabindex="-1" aria-labelledby="mensajeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="mensajeModalLabel">
                        <i class="fas fa-envelope me-2"></i>Enviar Mensaje
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="mensajeForm">
                        <div class="mb-3">
                            <label for="asunto" class="form-label">Asunto</label>
                            <input type="text" class="form-control" id="asunto" name="asunto" required>
                        </div>
                        <div class="mb-3">
                            <label for="mensaje" class="form-label">Mensaje</label>
                            <textarea class="form-control" id="mensaje" name="mensaje" rows="4" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="enviarMensaje()">
                        <i class="fas fa-paper-plane me-2"></i>Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Modal de Mensajes -->
    {% if current_user.is_authenticated and current_user.rol.Nombre in ['Administrador', 'Empleado'] %}
    <div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notificationModalLabel">
                        <i class="fas fa-envelope me-2"></i>Mensajes de Usuarios
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="fas fa-list me-2"></i>Lista de Mensajes
                                    </h6>
                                </div>
                                <div class="card-body p-0">
                                    <!-- Filtro de búsqueda -->
                                    <div class="message-filter">
                                        <div class="input-group">
                                            <span class="input-group-text">
                                                <i class="fas fa-search"></i>
                                            </span>
                                            <input type="text" class="form-control" id="messageFilter" 
                                                   placeholder="Buscar por nombre o asunto...">
                                        </div>
                                    </div>
                                    <!-- Lista de mensajes con scroll -->
                                    <div class="messages-list-container">
                                        <div id="mensajesList" class="list-group list-group-flush">
                                            <!-- Los mensajes se cargarán dinámicamente aquí -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="fas fa-comment me-2"></i>Detalle del Mensaje
                                    </h6>
                                </div>
                                <div class="card-body" id="mensajeDetalle">
                                    <div class="text-center text-muted">
                                        <i class="fas fa-envelope-open fa-3x mb-3"></i>
                                        <p>Selecciona un mensaje para ver su contenido</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="marcarTodasComoLeidas()">
                        <i class="fas fa-check-double me-2"></i>Marcar todas como leídas
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/alerts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/similares-scrollbar.js') }}"></script>
    <script>
        const currentYearElement = document.getElementById('currentYear');
        if (currentYearElement) {
            currentYearElement.textContent = new Date().getFullYear();
        }
        // Si el usuario vuelve con las flechas, recargamos desde el servidor
        if (performance.navigation.type === 2) {
            location.reload(true);
        }
        

    </script>
    {% block scripts %}{% endblock %}
    
    <!-- Botón flotante de ayuda para clientes -->
    {% if current_user.is_authenticated and current_user.rol.Nombre == 'Cliente' %}
    <div class="floating-help-btn" id="floatingHelpBtn">
        <div class="help-icon">
            <i class="fas fa-question-circle"></i>
        </div>
        <div class="help-tooltip">
            <span>¿Necesitas ayuda?</span>
        </div>
    </div>
    
    <!-- Modal de ayuda flotante -->
    <div class="modal fade" id="floatingHelpModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-headset me-2"></i>Centro de Ayuda
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-body text-center p-4">
                                    <div class="mb-3">
                                        <i class="fab fa-whatsapp text-success" style="font-size: 3rem;"></i>
                                    </div>
                                    <h6 class="card-title mb-3">WhatsApp Directo</h6>
                                    <p class="card-text text-muted small mb-3">
                                        Contacta directamente con nuestro administrador
                                    </p>
                                    <a href="https://wa.me/573001234567?text=Hola,%20necesito%20ayuda%20con%20mi%20reserva%20en%20Flash%20Reserver" 
                                       target="_blank" 
                                       class="btn btn-success btn-sm">
                                        <i class="fab fa-whatsapp me-2"></i>Contactar
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100 border-0 shadow-sm">
                                <div class="card-body text-center p-4">
                                    <div class="mb-3">
                                        <i class="fas fa-comments text-primary" style="font-size: 3rem;"></i>
                                    </div>
                                    <h6 class="card-title mb-3">Chat en Tiempo Real</h6>
                                    <p class="card-text text-muted small mb-3">
                                        Chatea directamente con nuestro equipo
                                    </p>
                                    <button type="button" 
                                            class="btn btn-primary btn-sm" 
                                            onclick="abrirChat()">
                                        <i class="fas fa-comments me-2"></i>Iniciar Chat
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chat flotante -->
    <div class="chat-widget" id="chatWidget" style="display: none;">
        <div class="chat-header">
            <div class="chat-title">
                <i class="fas fa-comments me-2"></i>
                <span>Soporte en Vivo</span>
            </div>
            <div class="chat-controls">
                <button class="btn btn-sm btn-outline-light" onclick="minimizarChat()">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="btn btn-sm btn-outline-light" onclick="cerrarChat()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="chat-body" id="chatBody">
            <div class="chat-messages" id="chatMessages">
                <div class="message admin-message">
                    <div class="message-content">
                        <p>¡Hola! ¿En qué podemos ayudarte hoy?</p>
                        <small class="message-time">Ahora</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="chat-footer">
            <div class="chat-input-container">
                <input type="text" 
                       class="form-control chat-input" 
                       id="chatInput" 
                       placeholder="Escribe tu mensaje..."
                       onkeypress="enviarMensajeChat(event)">
                <button class="btn btn-primary chat-send-btn" onclick="enviarMensajeChatBtn()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        // Navbar sticky con efectos de scroll
        document.addEventListener('DOMContentLoaded', function() {
            const navbar = document.querySelector('.navbar.sticky-top');
            if (navbar) {
                window.addEventListener('scroll', function() {
                    if (window.scrollY > 50) {
                        navbar.classList.add('scrolled');
                    } else {
                        navbar.classList.remove('scrolled');
                    }
                });
            }
        });
        
        // Función para confirmar cerrar sesión con SweetAlert2
        function confirmarCerrarSesion() {
            // Verificar si SweetAlert2 está disponible
            if (typeof Swal === 'undefined') {
                console.error('SweetAlert2 no está cargado');
                alert('Error: SweetAlert2 no está disponible');
                return;
            }
            
            Swal.fire({
                title: '¿Estás seguro?',
                text: '¿Estás seguro de cerrar sesión?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Sí, cerrar sesión',
                cancelButtonText: 'Cancelar',
                reverseButtons: true,
                customClass: {
                    popup: 'swal2-popup-custom',
                    confirmButton: 'swal2-confirm-button-custom',
                    cancelButton: 'swal2-cancel-button-custom'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // Redirigir a la ruta de logout
                    window.location.href = "{{ url_for('auth.logout') }}";
                }
            });
        }
    </script>
</body>
</html>
